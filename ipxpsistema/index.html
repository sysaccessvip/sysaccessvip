<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camino de Santidad</title>
          <link rel="apple-touch-icon" sizes="180x180" href="favicon_io/apple-touch-icon.png?v=1">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon_io/favicon-32x32.png?v=1">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon_io/favicon-16x16.png?v=1">
  <link rel="shortcut icon" href="favicon_io/favicon.ico?v=1" type="image/x-icon">
  <link rel="manifest" href="favicon_io/site.webmanifest?v=1">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div id="splashScreen">
        <div class="splash-loader"></div>
        <div class="text-white fw-bold tracking-widest">Camino de Santidad</div>
    </div>

    <div id="loginOverlay">
        <button class="btn btn-light rounded-circle position-absolute top-0 end-0 m-4 shadow-sm text-muted" onclick="closeLogin()" style="width: 40px; height: 40px; z-index: 2;"><i class="bi bi-x-lg"></i></button>
        
        <div class="login-card-pro">
            <div class="logo-placeholder">
                <img src="https://iili.io/fWiyr9p.png" alt="Logo Iglesia">
            </div>
            
            <h4 class="fw-bold text-dark mb-1">Camino de Santidad</h4>
            <p class="text-muted small mb-4">Ingresa tus credenciales.</p>
            
            <form onsubmit="event.preventDefault(); doLogin();">
                <div class="login-input-group">
                    <i class="bi bi-envelope"></i>
                    <input type="email" class="login-input-field" id="logEmail" placeholder="correo@iglesia.com" required>
                </div>

                <div class="login-input-group">
                    <i class="bi bi-shield-lock"></i>
                    <input type="password" class="login-input-field" id="logPass" placeholder="••••••••" required>
                </div>

                <button type="submit" class="btn-login-pro" id="btnLoginBtn">
                    <span id="btnLoginText">Conectarse</span>
                    <div id="btnLoginSpinner" class="spinner-border spinner-border-sm text-white d-none" role="status"></div>
                </button>
            </form>

<div class="mt-4 pt-3 border-top">
    <small class="text-muted" style="font-size: 0.75rem;">
        Sistema Seguro &copy; <span id="year"></span>
    </small>
</div>

<script>
    document.getElementById("year").textContent = new Date().getFullYear();
</script>
        </div>
    </div>

    <div class="overlay" onclick="toggleSidebar()"></div>

<nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo-box">
                <img src="https://iili.io/fWiyr9p.png" alt="Logo">
            </div>
            <div class="brand-text">
                <small>Sistema</small>
                <div>Camino de Santidad</div>
            </div>
        </div>

        <div class="nav flex-column px-3 mt-4 gap-2">
            
            <span class="menu-label">PRINCIPAL</span>
            <a href="#" class="nav-link active" onclick="loadPage('dashboard')" data-page="dashboard">
                <i class="bi bi-grid-1x2-fill"></i>
                <span>Vista General</span>
            </a>

            <span class="menu-label mt-3">FINANZAS</span>
            <a href="#" class="nav-link" onclick="loadPage('diezmos')" data-page="diezmos">
                <i class="bi bi-people-fill"></i>
                <span>Control Diezmos</span>
            </a>
            <a href="#" class="nav-link" onclick="loadPage('ofrendas')" data-page="ofrendas">
                <i class="bi bi-basket-fill"></i>
                <span>Registro Ofrendas</span>
            </a>

            <span class="menu-label mt-3">EGRESOS</span>
            <a href="#" class="nav-link" onclick="loadPage('pagos')" data-page="pagos">
                <i class="bi bi-arrow-down-circle-fill"></i>
                <span>Gastos / Salidas</span>
            </a>
        </div>

        <div class="mt-auto p-3 m-3 rounded-3 bg-white bg-opacity-10" id="authSection"></div>
    </nav>

    <div class="main-content">

<div class="d-flex flex-column flex-md-row justify-content-between align-items-center mb-4 gap-3">
    <div class="d-flex align-items-center w-100 justify-content-between justify-content-md-start">
        <div class="d-flex align-items-center">
            <button class="btn btn-light d-md-none me-3 shadow-sm" onclick="toggleSidebar()" style="width: auto; margin-bottom: 0;">
                <i class="bi bi-list"></i>
            </button>
            <h2 class="fw-bold m-0" id="pageTitle">Resumen</h2>
        </div>
    </div>
    
    <div class="date-pill w-100 w-md-auto">
        <i class="bi bi-calendar-range-fill text-primary fs-5"></i>
        
        <select id="monthSelector" class="clean-select" onchange="changeMonth(this.value)">
            <option value="-1" class="text-primary fw-bold">Todo el Año</option>
            <option value="0">Enero</option>
            <option value="1">Febrero</option>
            <option value="2">Marzo</option>
            <option value="3">Abril</option>
            <option value="4">Mayo</option>
            <option value="5">Junio</option>
            <option value="6">Julio</option>
            <option value="7">Agosto</option>
            <option value="8">Septiembre</option>
            <option value="9">Octubre</option>
            <option value="10">Noviembre</option>
            <option value="11">Diciembre</option>
        </select>

        <div class="separator-line"></div>

        <select id="yearSelector" class="clean-select text-muted" onchange="changeYear(this.value)" style="min-width: 60px;">
        </select>
        
        <button class="btn btn-sm btn-light rounded-circle text-primary ms-1 admin-only d-none" onclick="addYear()" title="Añadir año" style="width: 30px; height: 30px; padding: 0;">
            <i class="bi bi-plus-lg"></i>
        </button>
    </div>
</div>

        <div id="appContainer" class="fade-in" style="flex: 1;"></div>

        <footer class="text-center mt-5 py-4 border-top">
            <p class="text-muted small mb-0">&copy; 2026 Camino de Santidad - SysAccessVip</p>
        </footer>
    </div>

    <div class="modal fade" id="transactionModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header border-0 text-white" id="modalHeader" style="background: var(--corp-dark);">
                    <h5 class="modal-title fw-bold" id="modalTitle">Nuevo Registro</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="dataForm">
                        <input type="hidden" id="formType">
                        <div class="row g-3">
                            <div class="col-12">
                                <label class="form-label text-muted small fw-bold">FECHA</label>
                                <input type="date" class="form-control bg-light border-0" id="f_fecha" required>
                            </div>
                            
                            <div class="col-12 d-none field-conditional" id="divMesDiezmo">
                                <label class="form-label small fw-bold text-muted mb-2">SELECCIONAR GÉNERO</label>
                                <div class="gender-selector-container mb-3">
                                    <label class="gender-card" onclick="selectGender('M')" id="cardMale">
                                        <input type="radio" name="genero" value="M" class="gender-radio" checked>
                                        <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                        <span>Varón</span>
                                    </label>
                                    <label class="gender-card" onclick="selectGender('F')" id="cardFemale">
                                        <input type="radio" name="genero" value="F" class="gender-radio">
                                        <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
                                        <span>Mujer</span>
                                    </label>
                                </div>

                                <div class="p-3 rounded bg-light border mb-3">
                                    <label class="form-label text-primary fw-bold mb-1">Mes a cancelar</label>
                                    <select class="form-select border-0 bg-white" id="f_mes_diezmo">
                                        <option value="0">Enero</option><option value="1">Febrero</option><option value="2">Marzo</option>
                                        <option value="3">Abril</option><option value="4">Mayo</option><option value="5">Junio</option>
                                        <option value="6">Julio</option><option value="7">Agosto</option><option value="8">Septiembre</option>
                                        <option value="9">Octubre</option><option value="10">Noviembre</option><option value="11">Diciembre</option>
                                    </select>
                                </div>
                            </div>

                            <div class="col-12 d-none field-conditional" id="divOfrendaDia">
                                <label class="form-label fw-bold">Día de Culto</label>
                                <select class="form-select" id="f_dia_ofrenda">
                                    <option value="Miércoles">Miércoles</option><option value="Viernes">Viernes</option>
                                    <option value="Sábado">Sábado</option><option value="Domingo">Domingo</option>
                                    <option value="Especial">Especial</option>
                                </select>
                            </div>

                            <div class="col-12 d-none field-conditional" id="divPagoTipo">
                                <label class="form-label text-danger fw-bold">Categoría Gasto</label>
                                <select class="form-select" id="f_tipo_pago"></select>
                            </div>

                            <div class="col-12">
                                <label class="form-label text-muted small fw-bold" id="lblNombre">DETALLE</label>
                                <div class="search-dropdown-wrapper">
                                    <input type="text" class="form-control" id="f_nombre" placeholder="Escriba para buscar o agregar..." required autocomplete="off">
                                    <div class="search-suggestions" id="suggestionsBox"></div>
                                </div>
                            </div>
                            
                            <div class="col-12">
                                <label class="form-label text-muted small fw-bold">MONTO</label>
                                <div class="input-group">
                                    <span class="input-group-text border-0 bg-light fw-bold">S/.</span>
                                    <input type="number" step="0.01" class="form-control fw-bold fs-5" id="f_monto" required>
                                </div>
                            </div>

                            <div class="col-12">
                                <label class="form-label text-muted small fw-bold">VOUCHER (OPCIONAL)</label>
                                <input type="file" class="form-control" id="f_file" accept="image/*">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-0 pt-0">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary px-4" id="btnGuardar" onclick="saveTransaction()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="module" src="script.js"></script>

</body>

</html>

